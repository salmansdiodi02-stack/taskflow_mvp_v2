<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TaskFlow Admin</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<style>
  :root {
    --bg-light: #f5f7fb;
    --card-light: #ffffff;
    --text-light: #0b1220;
    --accent: #7c3aed;
    --muted: #6b7280;

    --bg-dark: #0f1724;
    --card-dark: #111827;
    --text-dark: #e5e7eb;
    --muted-dark: #9ca3af;
  }

  body {
    margin: 0;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: var(--bg-light);
    color: var(--text-light);
    transition: background 0.3s, color 0.3s;
  }

  [data-theme="dark"] body {
    background: var(--bg-dark);
    color: var(--text-dark);
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 18px 24px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
  }

  [data-theme="dark"] header {
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }

  .wrap {
    display: flex;
    min-height: calc(100vh - 64px);
  }

  .sidebar {
    width: 200px;
    background: #0b1320;
    color: #fff;
    padding: 24px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .brand {
    font-weight: 800;
    font-size: 18px;
    color: var(--accent);
    margin-bottom: 20px;
  }

  .nav {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .nav button {
    background: transparent;
    border: 0;
    color: #b0b8c4;
    padding: 10px 12px;
    border-radius: 8px;
    text-align: left;
    font-weight: 600;
    cursor: pointer;
    transition: 0.25s;
  }

  .nav button.active {
    background: rgba(124, 58, 237, 0.12);
    color: var(--accent);
  }

  .nav button:hover {
    background: rgba(124, 58, 237, 0.08);
    color: var(--accent);
  }

  .main {
    flex: 1;
    padding: 24px;
  }

  .card {
    background: var(--card-light);
    border-radius: 12px;
    padding: 18px;
    margin-bottom: 16px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  }

  [data-theme="dark"] .card {
    background: var(--card-dark);
    box-shadow: 0 4px 18px rgba(0,0,0,0.4);
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th, td {
    text-align: left;
    padding: 8px;
    border-bottom: 1px solid rgba(0,0,0,0.05);
  }

  [data-theme="dark"] th, [data-theme="dark"] td {
    border-bottom: 1px solid rgba(255,255,255,0.05);
  }

  th {
    font-weight: 700;
    color: var(--muted);
  }

  #tab-settings .panel {
    background: var(--card-light);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 14px;
  }

  [data-theme="dark"] #tab-settings .panel {
    background: var(--card-dark);
  }

  .btn {
    background: var(--accent);
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
    transition: 0.25s;
  }

  .btn:hover {
    opacity: 0.9;
  }

</style>
</head>
<body>
<div data-theme="light" id="root">
  <header>
    <div class="brand">TaskFlow</div>
    <div id="serverTime" style="font-size:13px;color:var(--muted)">â€”</div>
  </header>

  <div class="wrap">
    <aside class="sidebar">
      <div>
        <div class="nav">
          <button class="active" data-tab="dashboard">Dashboard</button>
          <button data-tab="leads">Leads</button>
          <button data-tab="snapshots">Snapshots</button>
          <button data-tab="settings">Settings</button>
        </div>
      </div>
      <div style="font-size:12px;color:#9ca3af">Logged in as Admin</div>
    </aside>

    <main class="main">
      <section id="tab-dashboard">
        <div class="card">
          <h2>Dashboard Overview</h2>
          <p style="color:var(--muted)">Real-time metrics</p>
          <canvas id="leadsChart"></canvas>
        </div>
      </section>

      <section id="tab-leads" style="display:none;">
        <div class="card">
          <h2>Leads</h2>
          <table>
            <thead><tr><th>Name</th><th>Phone</th><th>Service</th><th>When</th><th>Notes</th></tr></thead>
            <tbody id="leadsTbody"><tr><td colspan="5">Loading...</td></tr></tbody>
          </table>
        </div>
      </section>

      <section id="tab-snapshots" style="display:none;">
        <div class="card">
          <h2>Snapshots</h2>
          <div id="snapList" class="snapshots"><div class="small-muted">Loading snapshots...</div></div>
        </div>
      </section>

      <section id="tab-settings" style="display:none;">
        <div class="panel">
          <h3>Profile</h3>
          <p>Admin: <strong>Salman Ibrahim</strong></p>
        </div>
        <div class="panel">
          <h3>Theme</h3>
          <button id="themeToggle" class="btn">Switch Theme</button>
        </div>
        <div class="panel">
          <h3>System</h3>
          <p>Status: <span style="color:var(--accent)">Operational</span></p>
        </div>
      </section>
    </main>
  </div>
</div>

<script>
const root = document.getElementById("root");
const themeToggle = document.getElementById("themeToggle");
const storedTheme = localStorage.getItem("tf_theme") || "light";
applyTheme(storedTheme);

themeToggle.addEventListener("click", () => {
  const cur = root.getAttribute("data-theme");
  applyTheme(cur === "light" ? "dark" : "light");
});

function applyTheme(t) {
  root.setAttribute("data-theme", t);
  localStorage.setItem("tf_theme", t);
}

document.querySelectorAll('.nav button').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const tab = btn.dataset.tab;
    document.querySelectorAll('main section').forEach(s => s.style.display = (s.id === 'tab-'+tab ? '' : 'none'));
  });
});
</script>
</body>
</html>
